// Copyright (c) 2004-2008 Userwise Solutions LLC.  All rights reserved.

using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices; // DllImport

namespace NetCams
{
    public class Mach3ULink
    {

        [DllImport("Mach3ULink.Dll")]
        public static extern bool Mach3ObjectModelStartup();

        [DllImport("Mach3ULink.Dll")]
        public static extern void Mach3ObjectModelShutdown();

        [DllImport("Mach3ULink.Dll")]
        public static extern bool LoadGcodeFile(String filePath);

        [DllImport("Mach3ULink.Dll")]
        public static extern void Reset();

        [DllImport("Mach3ULink.Dll")]
        public static extern bool CycleStart();

        [DllImport("Mach3ULink.Dll")]
        public static extern void SetOEMDRO(short dro, double value);

        public static readonly short JOG_INC_INC_DRO			= 1;		// Jog Inc Inc DRO 1  

        public enum DROs : short // good enum tutorial: http://www.csharp-station.com/Tutorials/Lesson17.aspx
        {
            /*
    #define PULSE_FREQ_DRO			2		// Pulse Freq DRO 2  
    #define SLOW_JOG_PERCENT_DRO	3		// Slow Jog % DRO 3  
    #define X_MIN_DRO				4		// X min DRO 4  
    #define Y_MIN_DRO				5		// Y min DRO 5  
    #define Z_MIN_DRO				6		// Z min DRO 6  
    #define A_MIN_DRO				7		// A min DRO 7  
    #define B_MIN_DRO				8		// B min DRO 8  
    #define C_MIN_DRO				9		// C min DRO 9  
    #define X_MAX_DRO				10		// X max DRO 10  
    #define Y_MAX_DRO				11		// Y max DRO 11  
    #define Z_MAX_DRO				12		// Z max DRO 12  
    #define A_MAX_DRO				13		// A max DRO 13  
    #define B_MAX_DRO				14		// B max DRO 14  
    #define C_MAX_DRO				15		// C max DRO 15  
    #define G92_X_OFFSET_DRO		16		// X G92 Axis Off DRO 16  
    #define G92_Y_OFFSET_DRO		17		// Y G92 Axis Off DRO 17  
    #define G92_ZOFFSET_DRO			18		// Z G92 Axis Off DRO 18  
    #define G92_A_OFFSET_DRO		19		// A G92 Axis Off DRO 19  
    #define G92_B_OFFSET_DRO		20		// B G92 Axis Off DRO 20  
    #define G92_C_OFFSET_DRO		21		// C G92 Axis Off DRO 21  
    #define QUEUE_DEPTH_DRO			22		// Queue Depth DRO 22  
    #define TIME_SCALE_DRO			23		// Time Scale DRO 23  
    #define PWM_BASE_DRO			24		// PWM Base DRO 24  
    #define TORCH_SPEED_CRCT_DRO	25		// Torch Correction Speed DRO 25  
    #define TORCH_HEIGHT_CRCT_DRO	26		// Torch Height Corrorrection DRO 26  
    #define TORCH_HEIGHT_MAX_DRO	27		// Torch Height Max DRO 27  
    #define CPU_LOAD_DRO			28		// CPU Load DRO 28  
    #define ENCODER_X_DRO			29		// Encoder 1 (X) position DRO 29  
    #define ENCODER_Y_DRO			30		// Encoder 2 (Y) position DRO 30  
    #define ENCODER_Z_DRO			31		// Encoder 3 (Z) position DRO 31  
    #define TOOL_LEN_OFFSET_DRO		32		// Tool length offset 32  
    #define X_REF_SW_DRO			33		// X axis Ref Sw DRO 33  
    #define Y_REF_SW_DRO			34		// Y axis Ref Sw DRO 34  
    #define Z_REF_SW_DRO			35		// Z axis Ref Sw DRO 35  
    #define A_REF_SW_DRO			36		// A axis Ref Sw DRO 36  
    #define B_REF_SW_DRO			37		// B axis Ref Sw DRO 37  
    #define C_REF_SW_DRO			38		// C axis Ref Sw DRO 38  
    #define TRUE_SPINDLE_DRO		39		// True spindle DRO 39  
    #define WORST_CASE_DRO			40		// Worst Case DRO 40  
             */
            TOOL_X_OFFSET_DRO = 41,		// Tool X Offset DRO 41  
            /*
             * #define TOOL_Z_OFFSET_DRO		42		// Tool Z Offset DRO 42  
            #define TOLL_DIA_DRO			43		// Tool Dia DRO 43  
            #define TOOL_TIP_RAD_DRO		44		// Tool Tip Rad DRO 44  
            #define TOUCH_CORRECT_DRO		45		// Touch Correction DRO 45  
            #define CURR_FIXTURE_NUM_DRO	46		// Current Fixture Number DRO 46  
             */
            PART_X_OFFSET_DRO = 47,		// Part X Offset DRO 47  
            /*
    #define PART_Y_OFFSET_DRO		48		// Part Y Offset DRO 48  
    #define PART_Z_OFFSET_DRO		49		// Part Z Offset DRO 49  
    #define PART_A_OFFSET_DRO		50		// Part A Offset DRO 50  
    #define PART_B_OFSSET_DRO		51		// Part B Offset DRO 51  
    #define PART_C_OFFSET_DRO		52		// Part C Offset DRO 52  
    #define CPU_SPEED_DRO			53		// CPU Speed DRO 53  
    #define SAFE_Z_DRO				54		// Safe Z DRO 54  
    #define OVERRIDDEN_FEED_DRO		55		// Overidden Feed Rate DRO 55  
    #define PULLEY_DRO				56		// Pulley DRO 56  
    #define MAX_SPINDLE_PULLEY_DRO	57		// Max Spindle Speed on current pulley DRO 57  
    #define VEL_PER_REV_DRO			58		// Velocity per Rev DRO 58  
    #define X_SCALE_DRO				59		// X Scale DRO 59  
    #define Y_SCALE_DRO				60		// Y Scale DRO 60  
    #define Z_SCALE_DRO				61		// Z Scale DRO 61  
    #define A_SCALE_DRO				62		// A Scale DRO 62  
    #define B_SCALE_DRO				63		// B Scale DRO 63  
    #define C_SCALE_DRO				64		// C Scale DRO 64  
    #define LOW_TORCH_CORRECT_DRO	65		// Lowest Torch Correction DRO 65  
    #define THREAD_ENT_ANG_DRO		66		// Threading Entrance Angle DRO 66  
    #define MAX_ENT_POINTS_DRO		67		// Max Entrance Points DRO 67  
    #define ROT_TIME_ERR_DRO		68		// Rotational Time Error DRO 68  
    #define ENT_TRIGGER_DRO			69		// Entrance Trigger DRO 69  
    #define TIME_CORRECT_DERIV_DRO	70		// Time Correction Derivative DRO 70  
    #define INT_SPINDLE_REV_DRO		71		// Interrupts per spindle rev DRO 71  
    #define CURR_SPIN_COUNTS_DRO	72		// Current Spin Counts DRO 72  
    #define SPIN_ADDER_DRO			73		// Spin Adder DRO 73  
    #define SPIN_UPDN_INC_DRO		74		// Spin up/down increment DRO. 74  
    #define STOCK_SIZE_DRO			75		// Stock Size DRO 75  
    #define LASER_X_GRID_DRO		76		// Laser X Grid DRO 76  
    #define LASER_Y_GRID_DRO		77		// Laser Y Grid DRO 77  
    #define REPETITIONS_DRO			78		// Repetitions DRO 78  
    #define LOWER_Z_INHIBIT_BY_DRO	79		// Lower Z-Inhibit By DRO 79  
    #define Z_INHIBIT_DRO			80		// Z-Inhibit DRO 80  
    #define PORT_BIT_TEST_DRO		81		// Port Bit-test DRO (diagnostic) 81  
    #define ANTI_DIVE_LIMIT_DRO		82		// Anti-dive limit DRO 82  */
            X_MACHINE_COORD_DRO = 83,		// X Machine Coord DRO 83  
            /* #define Y_MACHINE_COORD_DRO		84		// Y Machine Coord DRO 84  
            #define Z_MACHINE_COORD_DRO		85		// Z Machine Coord DRO 85  
            #define A_MACHINE_COORD_DRO		86		// A Machine Coord DRO 86  
            #define B_MACHINE_COORD_DRO		87		// B Machine Coord DRO 87  
            #define C_MACHINE_COORD_DRO		88		// C Machine Coord DRO 88  
            #define BLEND_FACTOR_DRO		89		// Blend factor DRO 89  
            #define NUM_DISC_SLOTS_DRO		90		// Number of spindle disc slots DRO 90  
            #define G73_PULLOFF_VALUE_DRO	91		// G73 Pull-off value DRO 91  
            #define TAN_LIFT_THRESH_DRO		92		// Tangential lift threshold angle DRO 92  
            #define TAN_LIFT_Z_LEVEL_DRO	93		// Tangential lift Z level DRO 93  
                                                    // reserved 94  
                                                    // reserved 95  
                                                    // reserved 96  
            #define CV_FEEDRATE_DRO			97		// CV Feedrate DRO 97  
            #define FEED_OVERRIDE_INC_DRO	98		// Feed override increment value DRO 98  
            #define SPINDLE_RATIO_DRO		99		// ??? Spindle ratio DRO 99  
            #define ENC_4_POS_DRO			100		// Encoder 4 position DRO 100  
            #define MPG_1_COUNT_DRO			101		// MPG 1 count DRO 101  
            #define MPG_2_COUNT_DRO			102		// MPG 2 count DRO 102  
            #define MPG_3_COUNT_DRO			103		// MPG 3 count DRO 103  
            #define RAPID_FEEDRATE_DRO		104		// Rapid feedrate DRO 104  
            #define CURR_TOOL_DIA_DRO		105		// Diameter of current tool DRO 105  
            #define CURR_TOOL_TIP_DIR_DRO	106		// Tip direction of current tool DRO 106  
            #define CURR_TOOL_NOSE_RAD_DRO	107		// Tool nose radius of current tool DRO 107  
            #define CURR_TOOL_X_OFFSET_DRO	108		// X offset of current tool DRO 108  
            #define CURR_TOOL_Z_OFFSET_DRO	109		// Z offset of current tool DRO 109  
            #define CURR_TOOL_X_WEAR_DRO	110		// X wear offset of current tool DRO 110  
            #define CURR_TOOL_Z_WEAR_DRO	111		// Z wear offset of current tool DRO 111  
            #define CURR_TOOL_TURR_ANG_DRO	112		// Tool turret angle of current tool DRO 112  
            #define MPG_1_VELOCITY_DRO		113		// Velocity of MPG 1 DRO 113  
            #define MPG_2_VELOCITY_DRO		114		// Velocity of MPG 2 DRO 114  
            #define MPG_3_VELOCITY_DRO		115		// Velocity of MPG 3 DRO 115  
            #define MPG_CUT_TAPER_ANG_DRO	116		// Angle of taper to be cut with MPG tapering DRO 116  
            #define SPIND_SURF_SPEED_DRO	117		// Spindle speed as surface speed DRO 117  
            #define G68_ROT_ANG_DRO			118		// Angle of rotation of X/Y coordinate system (cf G68) 118  
            #define LASER_GRID_SPACE_DRO	119		// Laser grid spacing DRO 119  
            #define NUM_BUFF_INC_JOGS_DRO	120		// Number of incremental jogs that can be buffered DRO 120  
            #define MIN_SPINDLE_SPEED_DRO	121		// Minimum spindle speed on current pulley DRO 121  
            #define FEEDRATE_IGNORE_F_DRO	122		// Feed rate ignoring that set in F word DRO 122  
            #define TOOLPOST_FR_OFFSET_DRO	123		// Tool post offset (between front and rear posts DRO 123  
            #define MPG1_CURR_VEL_DRO		124		// Current velocity of MPG 1 DRO 124  
            #define MPG2_CURR_VEL_DRO		125		// Current velocity of MPG 2 DRO 125  
            #define MPG_STEPS_FEEDRATE_DRO	126		// Feedrate for use with MPG step jogs DRO 126  
            #define ENC1_ABS_X_ERR_DRO		127		// Error between Encoder 1 and abs X position DRO 127  
            #define ENC2_ABS_Y_ERR_DRO		128		// Error between Encoder 2 and abs Y position DRO 128  
            #define ENC3_ABS_Z_ERR_DRO		129		// Error between Encoder 3 and abs Z position DRO 129  
            #define INT_HAND_MS_DRO			130		// Time (uSec) in interrupt handler DRO 130  
            #define SLS_DIST_DRO			131		// SLS Dist - laser position measurement DRO 131  
            #define AXIS_6_TRIPCOUNT_DRO	132		// Axis 6 Tripcount - system debug use only DRO 132  
            #define ENGINE_LOOKAHEAD_DRO	133		// ??? Engine lookahead DRO 133  
            #define X_PULSE_COUNT			134		// Count of actual pulses output on X - debug use only DRO 134  
            #define Y_PULSE_COUNT			135		// Count of actual pulses output on Y - debug use only DRO 134  
            #define Z_PULSE_COUNT			136		// Count of actual pulses output on Z - debug use only DRO 134  
            #define A_PULSE_COUNT			137		// Count of actual pulses output on A - debug use only DRO 134  
            #define B_PULSE_COUNT			138		// Count of actual pulses output on B - debug use only DRO 134  
            #define C_PULSE_COUNT			139		// Count of actual pulses output on C - debug use only DRO 134  
            #define ENC1_ACTUAL_COUNT_DRO	140		// Actual count from encoder 1 - debug use only DRO 140  
            #define ENC2_ACTUAL_COUNT_DRO	141		// Actual count from encoder 2 - debug use only DRO 141  
            #define ENC3_ACTUAL_COUNT_DRO	142		// Actual count from encoder 3 - debug use only DRO 142  
            #define ENC4_ACTUAL_COUNT_DRO	143		// Actual count from encoder 4 - debug use only DRO 143  
            #define ENC5_ACTUAL_COUNT_DRO	144		// Actual count from encoder 5 - debug use only DRO 144  
            #define ENC6_ACTUAL_COUNT_DRO	145		// Actual count from encoder 6 - debug use only DRO 145  
            #define MODBUS_INPUT_64_DRO		146		// ModBus input 64 DRO 146  
            #define MODBUS_INPUT_65_DRO		147		// ModBus input 64 DRO 147  
            #define MODBUS_INPUT_66_DRO		148		// ModBus input 64 DRO 148  
            #define MODBUS_INPUT_67_DRO		149		// ModBus input 64 DRO 149  
            #define SOFTLIMIT_X_MAX_DRO		150		// Softlimit X Maximum DRO 150  
            #define SOFTLIMIT_Y_MAX_DRO		151		// Softlimit X Maximum DRO 151  
            #define SOFTLIMIT_Z_MAX_DRO		152		// Softlimit X Maximum DRO 152  
            #define SOFTLIMIT_A_MAX_DRO		153		// Softlimit X Maximum DRO 153  
            #define SOFTLIMIT_B_MAX_DRO		154		// Softlimit X Maximum DRO 154  
            #define SOFTLIMIT_C_MAX_DRO		155		// Softlimit X Maximum DRO 155  
            #define SOFTLIMIT_X_MIN_DRO		156		// Softlimit X Maximum DRO 156  
            #define SOFTLIMIT_Y_MIN_DRO		157		// Softlimit X Maximum DRO 157  
            #define SOFTLIMIT_Z_MIN_DRO		158		// Softlimit X Maximum DRO 158  
            #define SOFTLIMIT_A_MIN_DRO		159		// Softlimit X Maximum DRO 159  
            #define SOFTLIMIT_B_MIN_DRO		160		// Softlimit X Maximum DRO 160  
            #define SOFTLIMIT_C_MIN_DRO		161		// Softlimit X Maximum DRO 161  
            #define FR_TOOLPOST_DIST_DRO	162		// Distance from front to rear toolpost DRO 162
                                                    // reserved 163
                                                    // reserved 164
                                                    // reserved 165
                                                    // reserved 166
                                                    // reserved 167
                                                    // reserved 168
                                                    // reserved 169
            #define ENC1_UNITS_POS_DRO		170		// Encoder 1 position (in units) DRO  170  
            #define ENC2_UNITS_POS_DRO		171		// Encoder 1 position (in units) DRO  171  
            #define ENC3_UNITS_POS_DRO		172		// Encoder 1 position (in units) DRO  172  
            #define ENC4_UNITS_POS_DRO		173		// Encoder 1 position (in units) DRO  173  
                                                    // reserved 174
            #define X_TOUCH_RAD_DIA_DRO		175		// Part X radius/diameter for Touching to tooltable DRO  175  
            #define Z_TOUCH_RAD_DIA_DRO		176		// Part Z radius/diameter for Touching to tooltable DRO  176
                                                    // reserved 177  
                     */
            X_WORK_OFFSET_DRO = 178,		// Machine X coord - X Work Offset DRO  178 
            /*
    #define Y_WORK_OFFSET_DRO		179		// Machine Y coord - X Work Offset DRO  179  
    #define Z_WORK_OFFSET_DRO		180		// Machine Z coord - X Work Offset - Tool length DRO  180
    #define A_WORK_OFFSET_DRO		181		// Machine A coord - X Work Offset DRO  181  
    #define B_WORK_OFFSET_DRO		182		// Machine B coord - X Work Offset DRO  182  
    #define C_WORK_OFFSET_DRO		183		// Machine C coord - X Work Offset DRO  183  
    #define G52_G92_X_PNT_DRO		184		// X Cont. Pnt. coord (Machine - Work - G52/G92) DRO  184  
    #define G52_G92_Y_PNT_DRO		185		// Y Cont. Pnt. coord (Machine - Work - G52/G92) DRO  185  
    #define G52_G92_Z_PNT_DRO		186		// Z Cont. Pnt. coord (Machine - Work - G52/G92) DRO  186  
    #define G52_G92_A_PNT_DRO		187		// A Cont. Pnt. coord (Machine - Work - G52/G92) DRO  187  
    #define G52_G92_B_PNT_DRO		188		// B Cont. Pnt. coord (Machine - Work - G52/G92) DRO  188  
    #define G52_G92_C_PNT_DRO		189		// C Cont. Pnt. coord (Machine - Work - G52/G92) DRO  189  
    #define G28_X_HOME_DRO			190		// X axis home location used by G28 DRO  190  
    #define G28_Y_HOME_DRO			191		// Y axis home location used by G28 DRO  191  
    #define G28_Z_HOME_DRO			192		// Z axis home location used by G28 DRO  192  
    #define G28_A_HOME_DRO			193		// A axis home location used by G28 DRO  193  
    #define G28_B_HOME_DRO			194		// B axis home location used by G28 DRO  194  
    #define G28_C_HOME_DRO			195		// C axis home location used by G28 DRO  195  
    #define X_DIST_TOGO_DRO			196		// X axis Distance to Go DRO  196  
    #define Y_DIST_TOGO_DRO			197		// Y axis Distance to Go DRO  197  
    #define Z_DIST_TOGO_DRO			198		// Z axis Distance to Go DRO  198  
    #define A_DIST_TOGO_DRO			199		// A axis Distance to Go DRO  199  
    #define B_DIST_TOGO_DRO			200		// B axis Distance to Go DRO  200  
    #define C_DIST_TOGO_DRO			201		// C axis Distance to Go DRO  201  
    */
            X_DRO = 800,		// X DRO 800  
            Y_DRO = 801,		// Y DRO 801
            /*
            #define Z_DRO					802		// Z DRO 802  
            #define A_DRO					803		// A DRO 803  
            #define B_DRO					804		// B DRO 804  
            #define C_DRO					805		// C DRO 805  
            #define X_VEL_DRO				806		// X Vel DRO 806  
            #define Y_VEL_DRO				807		// Y Vel DRO 807  
            #define Z_VEL_DRO				808		// Z Vel DRO 808  
            #define A_VEL_DRO				809		// A Vel DRO 809  
            #define B_VEL_DRO				810		// B Vel DRO 810  
            #define C_VEL_DRO				811		// C Vel DRO 811  
                                                    // reserverd 812
            #define BLENDED_VEL_DRO			813		// Blended Velocity DRO 813  
            #define ELSPSED_TIME_DRO		814		// Elapsed DRO 814  
            #define ESTIMATED_TIME_DRO		815		// Estimate DRO 815  
            #define CURR_LINE_NUM_DRO		816		// Curr Line no DRO 816  
            #define SPINDLE_REQ_DRO			817		// Spindle requested DRO 817  
            #define FEEDRATE_DRO			818		// Feedrate DRO 818  
                                                    // reserved 819
                                                    // reserved 820
            #define FEEDRATE_OVERRIDE_DRO	821		// Feedrate Override (FRO) 821  
                                                    // reserved 822
                                                    // reserved 823
            #define TOOL_NUM_DRO			824		// Tool number DRO 824  
            #define ROTATE_A_DIA_DRO		825		// Rot A diameter DRO 825  
            #define ROTATE_B_DIA_DRO		826		// Rot A diameter DRO 826  
            #define ROTATE_C_DIA_DRO		827		// Rot A diameter DRO 827  
            #define JOG_INC_DRO				828		// Jog Inc DRO 828  
                                                    // reserved 829
            #define X_FIXTURE_OFFSET_DRO	830		// X Fixture Off DRO 830  
            #define Y_FIXTURE_OFFSET_DRO	831		// X Fixture Off DRO 830  
            #define Z_FIXTURE_OFFSET_DRO	832		// X Fixture Off DRO 830  
            #define A_FIXTURE_OFFSET_DRO	833		// X Fixture Off DRO 830  
            #define B_FIXTURE_OFFSET_DRO	834		// X Fixture Off DRO 830  
            #define C_FIXTURE_OFFSET_DRO	835		// X Fixture Off DRO 830  
            #define CURR_TOOL_LEN_DRO		836		// Current Tool length DRO 836  
            */
        }
    }
}
